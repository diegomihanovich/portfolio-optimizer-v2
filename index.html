<!--  ⚡ OPTIMIZADOR DE PORTAFOLIO 2.5 – WIZARD DARK  ⚡  -->
<!--  Autor: ChatGPT + Diego – 2025  -->
<!DOCTYPE html>
<html lang="es" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Optimizador de Portafolio v2.5</title>

  <!-- Fuentes + CSS propio -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />

  <!-- Plotly + Bootstrap (bundle) -->
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- App scripts -->
  <script defer src="js/app.js"></script>
</head>
<body class="bg-dark text-light">

  <div class="container py-4">

    <h1 class="text-center mb-4">Optimizador de Portafolio v2.5 <small class="text-secondary">(Compacto)</small></h1>

    <!-- Paso 1 -->
    <section id="step-1" class="wizard-step">
      <h2>Paso 1: Selección de Activos</h2>

      <div class="input-group mb-3">
        <input id="ticker-input" class="form-control" type="text"
               placeholder="Ej: AAPL, MSFT, BTC-USD…" autocomplete="off" />
        <button id="add-ticker" class="btn btn-primary">Añadir</button>
      </div>

      <p>Activos seleccionados: <span id="ticker-count">0/12</span></p>
      <div id="ticker-badges" class="mb-3"></div>

      <div class="row g-3">
        <div class="col-md-6">
          <h5>Heatmap Correlación <span data-bs-toggle="tooltip" title="Correlaciones histórico-mensuales entre activos">(?)</span></h5>
          <div id="heatmap" class="chart-box"></div>
        </div>
        <div class="col-md-6 d-flex flex-column align-items-center justify-content-center">
          <h5>Nivel Diversificación <span data-bs-toggle="tooltip" title="Score basado en la dispersión de correlaciones">(?)</span></h5>
          <div id="diversification-circle" class="metric-circle"></div>
        </div>
      </div>

      <div class="text-end mt-3">
        <button id="to-step-2" class="btn btn-outline-light">Siguiente →</button>
      </div>
    </section>

    <!-- Paso 2 -->
    <section id="step-2" class="wizard-step d-none">
      <h2>Paso 2: Ajuste de Parámetros</h2>

      <div class="row mb-3">
        <div class="col-md-6">
          <label class="form-label">Tasa Libre de Riesgo (Rf) <span data-bs-toggle="tooltip" title="En porcentaje anual">(?)</span></label>
          <div class="input-group">
            <input id="rf-input" type="number" step="0.0001" class="form-control" value="0.0425" />
            <button id="rf-refresh" class="btn btn-secondary">↻</button>
          </div>
        </div>
        <div class="col-md-6">
          <label class="form-label">Monto a Invertir <span data-bs-toggle="tooltip" title="En la divisa de referencia">(?)</span></label>
          <input id="capital-input" type="number" class="form-control" value="10000" />
        </div>
      </div>

      <label class="form-label">Nivel de Riesgo Deseado (0-100 %)</label>
      <input id="risk-slider" type="range" min="0" max="100" value="32" class="form-range" />
      <div class="d-flex justify-content-between mb-3">
        <small>0 %</small><small id="risk-label">32 %</small><small>100 %</small>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <label class="form-label">Frecuencia de Datos</label>
          <select id="freq-select" class="form-select">
            <option value="d">Diario</option>
            <option value="w">Semanal</option>
            <option value="m" selected>Mensual</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label">Rango Histórico</label>
          <select id="range-select" class="form-select">
            <option value="1y">1 Año</option>
            <option value="3y">3 Años</option>
            <option value="5y" selected>5 Años</option>
            <option value="10y">10 Años</option>
          </select>
        </div>
      </div>

      <h5>Configuraciones Avanzadas</h5>
      <div class="form-check">
        <input id="limit-checkbox" class="form-check-input" type="checkbox" />
        <label class="form-check-label">Limitar peso por activo al 25 %</label>
      </div>
      <div class="form-check">
        <input id="rebalance-checkbox" class="form-check-input" type="checkbox" />
        <label class="form-check-label">Rebalanceo automático (trimestral)</label>
      </div>
      <div class="form-check mb-3">
        <input id="defensive-checkbox" class="form-check-input" type="checkbox" />
        <label class="form-check-label">Incluir activos defensivos (bond ETFs)</label>
      </div>

      <div class="d-flex justify-content-between">
        <button id="back-to-1" class="btn btn-outline-light">← Anterior</button>
        <button id="to-step-3" class="btn btn-primary">Siguiente →</button>
      </div>
    </section>

    <!-- Paso 3 -->
    <section id="step-3" class="wizard-step d-none">
      <h2>Paso 3: Resultados de la Optimización</h2>

      <div class="row g-3">
        <div class="col-md-6">
          <h5>Frontera Eficiente <span data-bs-toggle="tooltip" title="5 000 carteras simuladas con Monte-Carlo">(?)</span></h5>
          <div id="efficient-frontier-chart" class="chart-box"></div>
        </div>
        <div class="col-md-6">
          <h5>Distribución Óptima <span data-bs-toggle="tooltip" title="Pesos en porcentaje">(?)</span></h5>
          <div id="weights-donut" class="chart-box"></div>
        </div>
      </div>

      <table class="table table-dark table-striped table-sm mt-3">
        <thead><tr><th>Métrica</th><th>Valor</th></tr></thead>
        <tbody id="metrics-table">
          <!-- Se rellena desde app.js -->
        </tbody>
      </table>

      <div class="text-end">
        <button id="run-optimize" class="btn btn-success btn-lg mt-2">Optimizar</button>
      </div>

      <div class="d-flex justify-content-between mt-3">
        <button id="back-to-2" class="btn btn-outline-light">← Anterior</button>
      </div>
    </section>

  </div><!-- /.container -->

  <!-- Spinner global -->
  <div id="loading-overlay" class="position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50 d-none
              align-items-center justify-content-center" style="z-index:1050;">
    <div class="spinner-border text-info" role="status" style="width:3rem;height:3rem;">
      <span class="visually-hidden">Cargando…</span>
    </div>
  </div>
</body>
</html>
